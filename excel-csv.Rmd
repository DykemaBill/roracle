---
title: "Excel to/from CSV Example"
author: "Dykema, Bill"
date: "2021/09/09"
output:
  html_document: default
---

## Notes for exporting to HTML file:
#### Set working directory: setwd("[Working Folder]")
#### install.packages("rmarkdown")
#### Knit to HTML for easy viewing: rmarkdown::render("excel-csv.Rmd", "all")

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Excel and CSV read and write example

# Load R libraries

```{r libraries}

## Load libraries

# Data analysis packages
#install.packages("tidyverse")
library(tidyverse)

# Excel package
# install.packages("xlsx")
library(xlsx)

```

## Read CSV file

```{r read_csv_file}

## Create DataFrame from CSV file
df_csv <- read.csv("testtable_source.csv", stringsAsFactors=FALSE)

## View your new DataFrame
df_csv

```

## Read Excel file

```{r read_excel_file}

## Create DataFrame from Excel file
df_excel <- read.xlsx2("testtable_source.xlsx", sheetIndex=1)

## View your new DataFrame
df_excel

```

## CSV Columns

```{r csv_columns}

## Display DataFrame columns
summary(df_csv)
str(df_csv)

```

## Excel Columns

```{r excel_columns}

## Display DataFrame columns
summary(df_excel)
str(df_excel)

```

## CSV Setup Columns

```{r csv_columns_setup}

# Copy DataFrame
df_csv_transformed <- df_csv
# Format date field in DataFrame
df_csv_transformed[['TEST_DATETIME']] <- as.POSIXct(df_csv_transformed[['TEST_DATETIME']], format="%Y/%m/%d %H:%M:%S")

# New option
df_csv_dateparts = t(as.data.frame(strsplit(df_csv_transformed[['TEST_DATETIME']], " ")))
row.names(df_csv_dateparts) = NULL
df_csv_transformed[['TEST_DATETIME']] <- chron(dates=df_csv_dateparts[,1],times=df_csv_dateparts[,2], format=c('y/m/d', 'h:m:s'))

```

## Write CSV to Excel
```{r csv_to_excel}

## Send CSV DataFrame to Excel file
write.xlsx2(df_csv, file='testtable_csv_export.xlsx')

```

## Write Excel to CSV
```{r excel_to_csv}

## Send Excel DataFrame to CSV file
write.csv(df_excel, file='testtable_csv_export.csv')

```

## Excel and CSV Combine into Single Excel/CSV
```{r excel_csv_combine}

# Append two DataFrames
df_excel_combined <- rbind(df_excel, df_csv)

# View combined DataFrame
df_excel_combined

## Send combined DataFrame to Excel and CSV file
write.xlsx2(df_excel_combined, file='testtable_combined_export.xlsx')
write.csv(df_excel_combined, file='testtable_combined_export.csv')

```